{-# OPTIONS_GHC -Wall #-}
module LogAnalysis where

import Log

-- | parse one line from a log file
parseMessage :: String -> LogMessage
parseMessage line = parse ws
  where ws = words line
        parse ("I":ts:msg)   = LogMessage Info (read ts) (unwords msg)
        parse ("W":ts:msg)   = LogMessage Warning (read ts) (unwords msg)
        parse ("E":s:ts:msg) = LogMessage (Error $ read s) (read ts) (unwords msg)
        parse w              = Unknown (unwords w)
